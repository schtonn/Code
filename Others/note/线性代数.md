扩展欧几里得：

1. 给定 $a,b,c\in Z$
   
   求 $ax+by=c$ 中 $x,y\in Z$

2. 给定 $a,c\in Z$
   
   求 $ax\equiv c\pmod m$ 中 $x$

   理解1：$ax\bmod m=c\bmod m$

   理解2：$ax-c=ym \rightarrow ax-ym=c$

3. 求 $a^{-1}\pmod m(x\in Z)$
   
   转为 $ax\equiv 1\pmod m\rightarrow ax+my=1$

设 $a=pb+q(-|b|<q<|b|)$

可用 `p=a/b`，`q=a%b` 或 $p=\lfloor\dfrac{a}{b}\rfloor$，$q=a\bmod b$。

$$(pb+q)x+by=c$$

$$b(px+y)+qx=c$$

$$bx'+qy'=c$$

$$\dots$$

$$gx^0+0y^0=c$$

$$x^0=\dfrac{c}{y},y^0=0$$

```
exgcd(a,b,c,&x,&y)
    if b=0:
        x=c/a
        y=0
        return
    exgcd(b,a%b,c,y,x)
    y-=(a/b)x
```

已解

$ax1+by1=g

$ax2+by2=c

2代入1，w=c/g

$a(x1*w)+b(y1*w)=c$


求ax+by=gcd(a,b)
```
exgcd(a,b,&x,&y)
    if b=0:
        x=1
        y=0
        return a
    int g=exgcd(b,a%b,y,x)
    y-=(a/b)x
    return g
```

上述方法求出特解x0y0，可证 $|x_0|\leq max\{1,|b|\},|y_0|\leq|a|$

$ax_0+by+0=\gcd$

令 $x=x_0+\Delta x$，$y=y_0+\Delta y$

$a\Delta x+b\Delta y=0$

$\Delta y=-(a\Delta x)/b=-{a/g\Delta x}/{b/g}$

设 $k\in Z$

Deltax=k b/g

Deltay=k a/g

{
x=x0+k b/g

y=y0-k a/g

中国剩余定理：
R=?

$R\equiv a_1\pmod m_1$

$R\equiv a_2\pmod m_2$

$R\equiv a_3\pmod m_3$

$\dots$

方法一：
$R+x_1m_1=a_1$

$R+x_2m_2=a_2$

上减下

$a1m1-x2m2=a1-a2$

求一通解

方法二：


$R=v_1+$|$v_2$|$\cdots+$|$v_t$
---------------------
$\bmod$|$m_1$|$a_1$|$$|$$

$\bmod$|$m_2$|0|a_2|

$\vdots$|$\vdots$|$\vdots$|$\vdots$

$\bmod m_t$|0|0|$\cdots$|$a_t$

设m1m2m3...两两互质

令 M=m1m2m3...mt

M/mi|Vi

要求V1=a1(mod m1)

xM/m1+ym1=a1

Vi=x-M/mi

求出x后代入，求出V1

同理求Vi

如果不是两两互质

如g=(m1,m2)>1，

有最大公约数时，直接除掉就好